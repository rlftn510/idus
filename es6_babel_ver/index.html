<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>idus babel</title>
  <meta name="description" content="아이디어스 과제입니다.">
  <meta property="og:title" content="idus">
  <meta property="og:description" content="아이디어스 과제입니다.">
  <link rel="stylesheet" href="./style/common.css">
  <link rel="stylesheet" href="./style/style.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.4.4/polyfill.js"></script>
</head>
<body>
  <div id="wrap">
    <!-- 과제 1. 카드 UI  -->
    <div class="item_list_wrap">
      <ul class="item_list clearfix">
        <li>
          <div class="item_list_box clearfix">
            <figure class="main_figure">
              <a href="" style="background-image:url(./img/fanda.jpg)" title="팬더"></a>
            </figure>
            <div class="item_des_wrap">
              <div class="top_des">
                  <a href="" class="label">card label</a>
                  <a href="" class="tit text_over_hid">card titleard titleard titleard titleard titleard titleard titleard title</a>
                  <a href="" class="item_price_group"><span class="high_font">Highlight</span><span class="mid_line">cross cut</span></a>
              </div>
              <div class="bot_des">
                  <div class="score_wrap">
                    <div>
                        <i class="score_item fas fa-star" data-star-num="1"></i>
                        <i class="score_item fas fa-star" data-star-num="2"></i>
                        <i class="score_item fas fa-star" data-star-num="3"></i>
                        <i class="score_item fas fa-star" data-star-num="4"></i>
                        <i class="score_item fas fa-star" data-star-num="5"></i>
                    </div>
                  </div>
                  <div class="item_des">
                      <p class="text_over_hid">안녕하세요? 류길수라고 합니다.합니다.</p>
                  </div>
                </div>
            </div>
          </div>
        </li>
        <li>
          <div class="item_list_box clearfix">
            <figure class="main_figure">
              <a href="" style="background-image:url(./img/fanda.jpg)" title="팬더"></a>
            </figure>
            <div class="item_des_wrap">
              <div class="top_des">
                  <a href="" class="label">card label</a>
                  <a href="" class="tit text_over_hid">card titleard titleard titleard titleard titleard titleard titleard title</a>
                  <a href="" class="item_price_group"><span class="high_font">Highlight</span><span class="mid_line">cross cut</span></a>
              </div>
              <div class="bot_des">
                  <div class="score_wrap">
                    <div>
                        <i class="score_item fas fa-star" data-star-num="1"></i>
                        <i class="score_item fas fa-star" data-star-num="2"></i>
                        <i class="score_item fas fa-star" data-star-num="3"></i>
                        <i class="score_item fas fa-star" data-star-num="4"></i>
                        <i class="score_item fas fa-star" data-star-num="5"></i>
                    </div>
                  </div>
                </div>
            </div>
          </div>
        </li>
        <li>
          <div class="item_list_box clearfix">
            <figure class="main_figure">
              <a href="" style="background-image:url(./img/fanda.jpg)" title="팬더"></a>
            </figure>
            <div class="item_des_wrap">
              <div class="top_des">
                  <a href="" class="label">card label</a>
                  <a href="" class="tit text_over_hid">card titleard titleard titleard titleard titleard titleard titleard title</a>
                  <a href="" class="item_price_group"><span class="high_font">Highlight</span><span class="mid_line">cross cut</span></a>
              </div>
              <div class="bot_des">
                  <div class="item_des">
                      <p class="text_over_hid">안녕하세요? 류길수라고 합니다.합니다.</p>
                  </div>
                </div>
            </div>
          </div>
        </li>
        <li>
          <div class="item_list_box clearfix">
            <figure class="main_figure">
              <a href="" style="background-image:url(./img/fanda.jpg)" title="팬더"></a>
            </figure>
            <div class="item_des_wrap">
              <div class="top_des">
                  <a href="" class="label">card label</a>
                  <a href="" class="tit text_over_hid">card titleard titleard titleard titleard titleard titleard titleard title</a>
                  <a href="" class="item_price_group"><span class="high_font">Highlight</span><span class="mid_line">cross cut</span></a>
              </div>
            </div>
          </div>
        </li>                              
      </ul>
    </div>



    <!-- 과제 1-2. 카드 UI  -->
    <div class="item_vertical_wrap">
      <ul class="item_list clearfix">
        <li>
          <div class="item_vertical_box">
            <figure class="main_figure">
              <a href="" style="background-image:url(./img/fanda.jpg)" title="팬더"></a>
            </figure>
            <div class="des_wrap">
              <a href="" class="tit text_over_hid">제목제목제목제목제목제목제목제목목제목제목목제목제목</a>
              <a href="" class="des text_over_hid line2">내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용</a>
              <div class="score_wrap">
                <div>
                    <i class="score_item fas fa-star" data-star-num="1"></i>
                    <i class="score_item fas fa-star" data-star-num="2"></i>
                    <i class="score_item fas fa-star" data-star-num="3"></i>
                    <i class="score_item fas fa-star" data-star-num="4"></i>
                    <i class="score_item fas fa-star" data-star-num="5"></i>
                </div>
                <span>| gilsu</span>
              </div>
            </div>
          </div>
        </li>
        <li>
          <div class="item_vertical_box">
            <figure class="main_figure">
              <a href="" style="background-image:url(./img/fanda.jpg)" title="팬더"></a>
            </figure>
            <div class="des_wrap">
              <a href="" class="tit text_over_hid">제목제목제목제목제목제목제목제목목제목제목목제목제목</a>
              <a href="" class="des text_over_hid line2">내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용</a>
              <div class="score_wrap">
                <div>
                    <i class="score_item fas fa-star" data-star-num="1"></i>
                    <i class="score_item fas fa-star" data-star-num="2"></i>
                    <i class="score_item fas fa-star" data-star-num="3"></i>
                    <i class="score_item fas fa-star" data-star-num="4"></i>
                    <i class="score_item fas fa-star" data-star-num="5"></i>
                </div>
                <span>| gilsu</span>
              </div>
            </div>
          </div>
        </li>
        <li>
          <div class="item_vertical_box">
            <figure class="main_figure">
              <a href="" style="background-image:url(./img/fanda.jpg)" title="팬더"></a>
            </figure>
            <div class="des_wrap">
              <a href="" class="tit text_over_hid">제목제목제목제목제목제목제목제목목제목제목목제목제목</a>
              <a href="" class="des text_over_hid line2">내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용</a>
              <div class="score_wrap">
                <div>
                    <i class="score_item fas fa-star" data-star-num="1"></i>
                    <i class="score_item fas fa-star" data-star-num="2"></i>
                    <i class="score_item fas fa-star" data-star-num="3"></i>
                    <i class="score_item fas fa-star" data-star-num="4"></i>
                    <i class="score_item fas fa-star" data-star-num="5"></i>
                </div>
                <span>| gilsu</span>
              </div>
            </div>
          </div>
        </li>
      </ul>
    </div>



    <!-- 과제 2. 입력 폼 UI -->
    <div class="require_box_wrap" data-state="false" id="memo_box_fir">
      <h2>defult</h2>
      <div>
        <textarea name="" class="require_box" cols="30" rows="10" placeholder="placeholder msg">처음 메시지 입니다.</textarea>
        <span class="str_max">500</span>
      </div>
      <button class="save_btn">save</button>
    </div>

    <div class="require_box_wrap" data-state="false" id="memo_box_sec">
      <h2>disabled</h2>
      <div>
        <textarea name="" disabled class="require_box" cols="30" rows="10" placeholder="placeholder msg"></textarea>
        <span class="str_max">500</span>
      </div>
      <button class="save_btn">save</button>
    </div>

    <div class="require_box_wrap" data-state="false" id="memo_box_thr">
      <h2>readonly</h2>
      <div>
        <textarea name="" readonly class="require_box" cols="30" rows="10" placeholder="placeholder msg">안녕하세요? 류길수 입니다.</textarea>
        <span class="str_max">500</span>
      </div>
      <button class="save_btn">save</button>
    </div>
  </div>


  <script type="text/babel">
  
  const starScore = (e) => {
    const target = e.target
    if (target.getAttribute('data-star-num')) {
      const starNum = target.getAttribute('data-star-num')
      const targetParent = target.parentElement
      const childStar = targetParent.querySelectorAll('.score_item')

      targetParent.setAttribute('data-all-score', starNum )
      // 타겟의 부모에게 타겟의 점수를 부여하여 몇점인지 알게함

      Array.from(childStar).forEach((el) => {
        if(el.getAttribute('data-star-num') <= starNum) {
          el.style.color = 'red'
        } else {
          el.style.color = 'black'
        }
      });
      // 타겟 이하의 점수에게 색을 주어 구분함
    } 
  }


  class Validation {
    constructor(elementId, limit){
      // 모듈의 아이디 값, 제한 글자수를 인자로 받습니다.
      this.elementId = document.getElementById(elementId)
      //아이디
      this.target = null
      //이벤트 타겟
      this.firValue = null
      //처음 입력된 메시지
      this.limit = limit
      //제한 글자수
    }

    firstMemo() {
      this.target = this.elementId.querySelector('textarea')
      this.firValue = this.target.value
      //초기 입력값을 받아 비교
    }

    textValidation(){
      const maxLen = this.limit
      //최대 입력 글자수를 담음
      const element = this.elementId
      const strMax = element.querySelector('.str_max')
      const textarea = this.target
      const strLen = textarea.value.length
      const curLen = maxLen - strLen
      // 최대 글자수와 현재 글자수 차이를 구하여 대입
      strMax.innerText = maxLen
      this.target.setAttribute('data-max', maxLen)

      if(strLen > 0 && this.firValue !== textarea.value) {
        // 메모에 내용이 없을 시 && 초기 입력값이랑 내용이 같을 시 저장 못하게함
        element.setAttribute('data-state', 'true')
      } else {
        element.setAttribute('data-state', 'false')
      }

      if (maxLen < strLen) {
        //지정된 글자수를 초과를 막음
        textarea.value = textarea.value.substr(0, maxLen)
        strMax.innerHTML = 0
      } else {
        strMax.innerHTML = curLen
      }
    }

    init(){
      this.firstMemo()
      this.textValidation()
    }
  }



  const arrInput = document.querySelectorAll('textarea, input')
  const rowIePlaceholder = () => {
    Array.from(arrInput).forEach((el) => {
      if(el.getAttribute('placeholder').length > 0 && el.value == "") {
        el.value = el.getAttribute('placeholder')
        el.nextSibling.innerHTML = el.getAttribute('data-max')
      }
      el.addEventListener('focus', () => {
          if(el.value === el.getAttribute('placeholder')){
            el.value = ""
          }
        })
      el.addEventListener('blur', () => {
        if(el.value === "") {
          el.value = el.getAttribute('placeholder')
        }
      })
    })
  }

  const ieReadonly = () => {
    Array.from(arrInput).forEach((el) => {
      if(el.getAttribute('readonly') == '' || el.getAttribute('readonly') == 'true') {
        el.className += ' readonly'
      }
    })
  }

  const ieCheck = () => {
    const userAgent = navigator.userAgent;
    if (userAgent.indexOf('MSIE') !== -1 || userAgent.indexOf('Trident/') > 0) {
      ieReadonly()
      // ie일경우 ieReadonly 함수실행
      let rv = 0;
      let re = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})"); 
      if (re.exec(userAgent) != null) {
        rv = parseFloat(RegExp.$1); 
      }
      if (rv != 0 && rv <= 9) {
        rowIePlaceholder()
        // ie 버전이 9이하일 경우 placeholder 함수 실행
      } 
    }
  }
  
  const validation = new Validation('memo_box_fir', '100')
  const validationSec = new Validation('memo_box_sec', '200')
  const validationThr = new Validation('memo_box_thr', '300')

  validation.init()
  validationSec.init()
  validationThr.init()
  validation.target.addEventListener('keyup',() => validation.textValidation())
  document.addEventListener('click', starScore)
  ieCheck()

  </script>
</body>
</html>